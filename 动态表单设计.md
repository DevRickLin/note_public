#wip #frontend #案例梳理
# 前言
无论是在实习中，还是后续的开发中，我经常遇到适合动态表单的场景。知乎上的[这篇文章](https://zhuanlan.zhihu.com/p/382557892)，将动态表单的优势与劣势分析的十分透彻。其实我们不妨去想，动态表单的本质和腾讯文档，问卷星是相同的，不适合这类问卷服务的场景，通常也不适合动态表单。这类场景的特点是：

1. 有重复性的，功能类似的字段
2. 需要一定的动态能力
3. 字段数量极大

动态表单开发的基本思路是，通过DSL及parser将重复的模式抽象为简洁的抽象，其带来的优势有三:

1. 动态能力，可以根据场景动态的返回不同配置，显示不同表单
2. 可维护性，具体配置和实现解耦，共同依赖DSL抽象。
3. 基于虚拟列表这类技术，可以实现大型表单的高性能渲染。

实际上，阿里巴巴的`Formily`对动态表单提供了一个更高层的思想。其将动态列表方案分为四层：

1. 协议层
2. 工具层
3. 渲染引擎层
4. 表单组基层

# 实现

## 问题分析

### 生命周期

根据不同的需求场景，动态表单可能会采用不同的生命周期设计。以`创建, 填写， 提交`三个阶段为例，这三个阶段有各自要解决的需求：

#### 创建

1. 如果动态表单是普通用户生成的，怎么设计一个服务让用户简单的创建配置文件
2. 如果是面向开发者用户的，那么怎么设计可读性高，方便简洁的配置文件字段
3. 怎么将以上面向用户的配置，转换成面向机器的协议

#### 填写

1. 怎么从协议渲染成可交互的视图
2. 如何处理视图的交互，管理输入的内容

#### 提交

1. 怎么做表单内容的验证？后端验证还是前端验证？跨前后端的系统专门设计？
2. 怎么将输入的内容发送到后端？怎么设计协议？
3. 怎么处理返回结果的回调？

## DSL设计

1. https://json-schema.org/

## 顶层组件设计

1. Ioc思想支持多态子组件（基于JSX的动态能力
2. 复杂状态管理（基于flux思想设计）
# 参考
https://zhuanlan.zhihu.com/p/382557892
https://developer.aliyun.com/article/748028#slide-12